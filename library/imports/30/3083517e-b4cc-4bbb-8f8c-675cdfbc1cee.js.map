{"version":3,"sources":["assets\\Scripts\\Popups\\PopupManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Helper from \"../utils/Helper\";\r\nimport SingletonNode from \"../utils/SingletonNode\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\nexport enum Popups\r\n{\r\n    \r\n}\r\n@ccclass\r\nexport default class PopupManager extends SingletonNode<PopupManager>() {\r\n\r\n    @property(cc.Node) private PopupBackground: cc.Node = null;\r\n    @property(cc.Node) private PopupContainer: cc.Node = null;\r\n    @property(cc.Node) private ShownPopups: cc.Node = null;\r\n    @property(cc.Prefab) private PopupPrefabs: Array<cc.Prefab> = [];\r\n\r\n    private mShowCallback;\r\n    private mHideCallback;\r\n    static push(popupName: Popups, useBg = true)\r\n    {\r\n        const instance = this.Instance;\r\n        const popup = instance.PopupContainer.getChildByName(Popups[popupName]);\r\n        if (popup)\r\n        {\r\n            instance.usePopup(popup);\r\n            instance.animate(true, popup);\r\n            instance.PopupBackground.active = useBg;\r\n        }\r\n    }\r\n\r\n    static pop()\r\n    {\r\n        const instance = this.Instance;\r\n        if (instance.ShownPopups.children.length > 0)\r\n        {\r\n            const popup = instance.ShownPopups.children[instance.ShownPopups.children.length - 1];\r\n            instance.PopupBackground.active = instance.ShownPopups.children.length - 1 > 0;\r\n            instance.animate(false, popup);\r\n        }\r\n    }\r\n\r\n    static hide(popupName: Popups)\r\n    {\r\n        const instance = this.Instance;\r\n        const popup = instance.ShownPopups.getChildByName(Popups[popupName]);\r\n        if (popup)\r\n        {\r\n            instance.animate(false, popup);\r\n        }\r\n    }\r\n\r\n    static getPopup(popupName: Popups)\r\n    {\r\n        const instance = this.Instance;\r\n        let popup = instance.PopupContainer.getChildByName(Popups[popupName]);\r\n        if (popup)\r\n        {\r\n            return popup;\r\n        }\r\n        return instance.ShownPopups.getChildByName(Popups[popupName]);\r\n    }\r\n    private animate(isShow: boolean, popup: cc.Node)\r\n    {\r\n        if (!isShow)\r\n        {\r\n            let randomEasing = ['bounceOut', 'quadOut', 'backOut']\r\n            let easing = randomEasing[Helper.RandInt(0, randomEasing.length - 1)]\r\n            cc.tween(popup)\r\n                .to(0.3, { scale: 0, }, { easing: 'quadIn' })\r\n                .call(() =>\r\n                {\r\n                    this.returnPopup(popup);\r\n                    // this.PopupBackground.active = this.ShownPopups.children.length > 0;\r\n                })\r\n                .start()\r\n        } else \r\n        {\r\n            let randomEasing = ['bounceOut', 'quadOut', 'backOut']\r\n            let easing = randomEasing[Helper.RandInt(0, randomEasing.length - 1)]\r\n            popup.setScale(0)\r\n            cc.tween(popup)\r\n                .by(0.3, { scale: 1, }, { easing: easing })\r\n                .start()\r\n        }\r\n    }\r\n\r\n    private usePopup(popup: cc.Node)\r\n    {\r\n        this.PopupContainer.removeChild(popup, false);\r\n        this.ShownPopups.addChild(popup);\r\n    }\r\n\r\n    private returnPopup(popup: cc.Node)\r\n    {\r\n        this.ShownPopups.removeChild(popup, false);\r\n        this.PopupContainer.addChild(popup);\r\n    }\r\n\r\n    onLoad()\r\n    {\r\n        super.onLoad();\r\n        for (let i = 0; i < this.PopupPrefabs.length; i++)\r\n        {\r\n            this.PopupContainer.addChild(cc.instantiate(this.PopupPrefabs[i]));\r\n        }\r\n    }\r\n    \r\n    start()\r\n    {\r\n        \r\n    }\r\n    \r\n}\r\n"]}